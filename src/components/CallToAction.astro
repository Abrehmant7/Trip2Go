---
import { Image } from "astro:assets";
import heroImg from "../assets/last-section.jpg";
---

<!-- Call to Action Section -->
<section
    id="cta-section"
    class="relative py-24 md:py-32 flex items-center justify-center overflow-hidden"
>
    <!-- Background Image -->
    <div class="absolute inset-0 z-0 overflow-hidden">
        <div id="cta-bg" class="w-full h-full scale-110">
            <Image
                src={heroImg}
                alt="Travel Adventure"
                class="w-full h-full object-cover"
                widths={[320, 480, 640, 1024, 1920]}
                quality={80}
                sizes="(max-width: 640px) 100vw, 100vw"
            />
            <div class="absolute inset-0 bg-black/50"></div>
        </div>
    </div>

    <!-- Content -->
    <div
        id="cta-content"
        class="relative z-10 text-center px-4 max-w-4xl mx-auto opacity-0 translate-y-4"
    >
        <h2
            class="text-4xl md:text-6xl font-extrabold text-white mb-8 leading-tight drop-shadow-xl"
        >
            Start Your Next Great <br />Adventure With Trip2Go
        </h2>
        <a
            href="/contact"
            class="bg-brand-yellow text-gray-900 font-bold py-4 px-10 text-lg rounded-none hover:bg-white transition-all duration-300 shadow-xl transform hover:-translate-y-1 inline-block"
        >
            Contact Us
        </a>
    </div>
</section>

<script>
    import { gsap } from "gsap";

    document.addEventListener("astro:page-load", () => {
        const section = document.getElementById("cta-section");
        const bg = document.getElementById("cta-bg");
        const content = document.getElementById("cta-content");

        if (section && bg && content) {
            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach((entry) => {
                        if (entry.isIntersecting) {
                            // Background Zoom Effect (Slow zoom out)
                            gsap.to(bg, {
                                scale: 1,
                                duration: 3, // Slower, cinematic
                                ease: "power2.out",
                            });

                            // Content Pop & Blur Reveal
                            gsap.fromTo(
                                content,
                                {
                                    opacity: 0,
                                    scale: 0.8,
                                    filter: "blur(10px)",
                                    y: 20,
                                },
                                {
                                    opacity: 1,
                                    scale: 1,
                                    filter: "blur(0px)",
                                    y: 0,
                                    duration: 1.2,
                                    ease: "back.out(1.2)", // "Pop" effect
                                    delay: 0.2, // Slight delay after background starts
                                },
                            );

                            observer.unobserve(section);
                        }
                    });
                },
                { threshold: 0.3 },
            );

            observer.observe(section);
        }
    });
</script>
