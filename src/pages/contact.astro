---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import heroImage from "../assets/contact.jpg";
import { Icon } from "astro-icon/components";

interface FormField {
    id: number;
    name: string;
    type: "text" | "email" | "tel";
    placeholder: string;
}

const formFields: FormField[] = [
    {
        id: 1,
        name: "fullname",
        type: "text",
        placeholder: "John Doe",
    },
    {
        id: 2,
        name: "email",
        type: "email",
        placeholder: "john@example.com",
    },
    {
        id: 3,
        name: "phone",
        type: "tel",
        placeholder: "+1 (555) 000-0000",
    },
    {
        id: 4,
        name: "nationality",
        type: "text",
        placeholder: "e.g., American",
    },
    {
        id: 5,
        name: "destination",
        type: "text",
        placeholder: "e.g., Australia, Paris",
    },
    {
        id: 6,
        name: "current_city",
        type: "text",
        placeholder: "e.g., New York",
    },
];
---

<Layout>
    <Hero
        PageName="contact"
        image={heroImage}
        title="Contact Us"
        subtitle="Get in touch with us to start your journey."
    />
    <main class="bg-gray-50">
        <!-- Contact Form Section -->
        <section class="-mt-24 pb-24 px-4 sm:px-6 lg:px-8 relative z-20">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white rounded-none shadow-2xl p-8 md:p-12">
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">
                            Contact Us
                        </h2>
                        <p class="text-lg text-brand-blue font-semibold">
                            Fill this form out and our agents will reach you out
                            soon
                        </p>
                    </div>

                    <form
                        action="https://api.web3forms.com/submit"
                        method="POST"
                        class="space-y-6"
                    >
                        <input
                            type="hidden"
                            name="access_key"
                            value={import.meta.env.PUBLIC_WEB3FORMS_KEY}
                        />
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Full Name -->
                            {
                                formFields.map((field) => (
                                    <div class="relative group">
                                        <label
                                            for={field.name}
                                            class="block text-sm font-medium text-gray-700 mb-1 group-hover:text-brand-blue transition-colors"
                                        >
                                            {field.name}
                                        </label>
                                        <div class="relative">
                                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                <Icon
                                                    name="ri:user-line"
                                                    class="text-gray-400 group-focus-within:text-brand-blue transition-colors"
                                                />
                                            </div>
                                            <input
                                                type={field.type}
                                                id={field.name}
                                                name={field.name}
                                                class="block w-full pl-10 pr-3 py-3 border border-gray-200 rounded-none focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all bg-gray-50 focus:bg-white"
                                                placeholder={field.placeholder}
                                            />
                                        </div>
                                    </div>
                                ))
                            }
                        </div>

                        <!-- Submit Button -->
                        <div class="pt-6 text-center">
                            <button
                                type="submit"
                                class="w-full md:w-auto bg-brand-yellow text-gray-900 font-bold py-4 px-12 text-lg rounded-none shadow-lg hover:bg-yellow-400 hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 mx-auto"
                            >
                                <span>Send Enquiry</span>
                                <Icon name="ri:send-plane-fill" />
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Customer Support Card -->
                <div
                    class="mt-12 bg-brand-blue rounded-none shadow-xl overflow-hidden text-center p-8 md:p-12"
                >
                    <h2 class="text-3xl font-bold text-white mb-6">
                        Have Questions?
                    </h2>
                    <p class="text-blue-100 text-lg mb-8">
                        Our customer support team is here to assist you 24/7.
                    </p>

                    <div
                        class="grid grid-cols-1 md:grid-cols-3 gap-8 text-blue-50"
                    >
                        <!-- Email -->
                        <div class="flex flex-col items-center">
                            <Icon
                                name="ri:mail-send-line"
                                class="text-4xl text-brand-yellow mb-4"
                            />
                            <h3 class="font-bold text-white text-xl mb-2">
                                Email Us
                            </h3>
                            <a
                                href="mailto:info@trip2go.co.uk"
                                class="hover:text-brand-yellow transition-colors text-lg"
                            >
                                info@trip2go.co.uk
                            </a>
                        </div>

                        <!-- Phone -->
                        <div class="flex flex-col items-center">
                            <Icon
                                name="ri:customer-service-2-line"
                                class="text-4xl text-brand-yellow mb-4"
                            />
                            <h3 class="font-bold text-white text-xl mb-2">
                                Customer Support
                            </h3>
                            <ul class="space-y-2 text-lg">
                                <li>
                                    <a
                                        href="tel:07404562424"
                                        class="hover:text-brand-yellow transition-colors"
                                        >07404562424</a
                                    >
                                </li>
                                <li>
                                    <a
                                        href="tel:+447403650851"
                                        class="hover:text-brand-yellow transition-colors"
                                        >+44 7403 650851</a
                                    >
                                </li>
                                <li>
                                    <a
                                        href="tel:+447403624900"
                                        class="hover:text-brand-yellow transition-colors"
                                        >+44 7403 624900</a
                                    >
                                </li>
                            </ul>
                        </div>

                        <!-- Address -->
                        <div class="flex flex-col items-center">
                            <Icon
                                name="ri:map-pin-line"
                                class="text-4xl text-brand-yellow mb-4"
                            />
                            <h3 class="font-bold text-white text-xl mb-2">
                                Visit Us
                            </h3>
                            <p class="text-lg">
                                3 Maryam close Rainham<br />RM 13 9PE, London
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</Layout>

<!-- Success Modal -->
<div
    id="success-modal"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 backdrop-blur-sm"
>
    <div
        class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4 text-center transform transition-all scale-100"
    >
        <div
            class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"
        >
            <Icon
                name="ri:checkbox-circle-fill"
                class="text-4xl text-green-500"
            />
        </div>
        <h3 class="text-2xl font-bold text-gray-900 mb-2">Message Sent!</h3>
        <p class="text-gray-600 mb-8">
            Thank you for contacting us. Our team will get back to you shortly.
        </p>
        <button
            id="close-modal"
            class="bg-brand-blue text-white font-bold py-3 px-8 rounded-lg hover:bg-brand-yellow hover:text-gray-900 transition-colors w-full"
        >
            Close
        </button>
    </div>
</div>

<script is:inline>
    const form = document.querySelector("form");
    const modal = document.getElementById("success-modal");
    const closeBtn = document.getElementById("close-modal");

    if (form) {
        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;

            // Show loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = "<span>Sending...</span>";

            try {
                const response = await fetch(
                    "https://api.web3forms.com/submit",
                    {
                        method: "POST",
                        body: formData,
                    },
                );

                if (response.status === 200) {
                    // Success
                    form.reset();
                    modal.classList.remove("hidden");
                    modal.classList.add("flex");
                } else {
                    alert("Something went wrong. Please try again.");
                }
            } catch (error) {
                console.error(error);
                alert("Something went wrong. Please try again.");
            } finally {
                // Reset button
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        });
    }

    if (closeBtn && modal) {
        closeBtn.addEventListener("click", () => {
            modal.classList.add("hidden");
            modal.classList.remove("flex");
        });

        // Close on background click
        modal.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.classList.add("hidden");
                modal.classList.remove("flex");
            }
        });
    }
</script>
